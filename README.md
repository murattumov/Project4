# Проект 4.  Прогнозирование открытия депозита клиентом банка

## Оглавление
[1. Описание проекта](https://github.com/murattumov/project4/blob/master/README.md#Описание-проекта)

[2. Какой кейс решаем?](https://github.com/murattumov/project4/blob/master/README.md#Какой-кейс-решаем)

[3. Краткая информация о данных](https://github.com/murattumov/project4/blob/master/README.md#Краткая-информация-о-данных)

[4. Этапы работы над проектом](https://github.com/murattumov/project4/blob/master/README.md#Этапы-работы-над-проектом)

[5. Результат](https://github.com/murattumov/project4/blob/master/README.md#Результат)

[6. Краткая информация](https://github.com/murattumov/project4/blob/master/README.md#Краткая-информация)

### **Описание проекта**

Нам предоставили данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Мы должны проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. Это поднимет доходы банка и поможет понять целевую аудиторию, которую необходимо привлекать путём рекламы и различных предложений.

### **Какой кейс решаем?**
Построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет. Определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.
Необходимо изучить данные. Очистить данные от пропущенных значений и дупликатов. Провести разведывательный анализ данных: получение и проектирование новых данных, отбор признаков, кодирование признаков  и проверка на мультиколлинеарность признаков.  Обучить разные модели ML с оптимизацией гиперпараметров, который будет предсказывать открытие депозита клиентом, и выбрать наилучший. 

### **Краткая информация о данных**
База данных представляет собой данные о проведении маркетинговых кампаний и взаимодействий с клиентами для открытия депозита. Состоит из 11162 строк и 16 признаков: кроме целевого, 7 числового типа и 9 типа object. 
Признаки:
Данные о клиентах банка:

- age (возраст);
- job (сфера занятости);
- marital (семейное положение);
- education (уровень образования);
- default (имеется ли просроченный кредит);
- housing (имеется ли кредит на жильё);
- loan (имеется ли кредит на личные нужды);
- balance (баланс).
         

Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:

- contact (тип контакта с клиентом);
- month (месяц, в котором был последний контакт);
- day (день, в который был последний контакт);
- duration (продолжительность контакта в секундах).

Прочие признаки:

- campaign (количество контактов с этим клиентом в течение текущей кампании);
- pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
- previous (количество контактов до текущей кампании)
- poutcome (результат прошлой маркетинговой кампании).

И, разумеется, наша целевая переменная deposit, которая определяет, согласится ли клиент открыть депозит в банке. Именно её мы будем пытаться предсказать в данном кейсе.


### **Этапы работы над проектом**

- Анализ структуры данных
  1. Пропущенные значения в признаке "balance". Также есть пропущенные значения в признаках "job" и "educations" обозначеные специальным словом "unknown" и в признаке "pdays" под символом "-1".
  2. Число найденных дубликатов: 0. Сразу же убираем дубликаты


- Преобразование и получение новых признаков

  1. преобразуем признак balance таким образом, чтобы он корректно считывался, как вещественное число (float)
  2. обработаем пропуски в признаки balance , заменив их на медианные значения по данному признаку
  3. обработаем пропуски в категориальных признаках: job и education, заменив их на модальные значения
  4. удаляем выбросы для признака balance. Число выбросов по методу Тьюки: 1057.
  5. удаляем выбросы для признака duration. Число выбросов по методу Тьюки: 591.
  6. выбросы для признака previous переводим в категориальные признаки. записываем previous>3, как '>3'
  7. изучаем сбалансированность класса у целевого признака "deposit".
  8. вывод описательные статистики для как для числовой так и для категориальных признаков
  9. преобразуем уровни образования и уровни возраста. кодируем с помощью LabelEncoder
  10. преобразуем бинарные переменные в представление из нулей и единиц. кодируем с помощью LabelBinarizer признаки: 'loan', 'housing', 'default' и 'deposit'.
  11. создайте дамми-переменные для признаков: 'job', 'marital', 'contact', 'month', 'poutcome' 
  12. построем корреляционную матрицу и оценим данные на предмет наличия мультиколлинеарности. Видим мультиколлинеарность между previous_0 и poutcome_unknown. Убираем poutcome_unknown.
  13. с помощью SelectKBest отиераем 15 наиболее подходящих признаков.
  14. нормализуем данные с помощью minmaxsxaler
  

- Обучение модели
  
  1. обучаем логистическую регрессию, парметры по умолчанию, и рассчитываем метрики качества
  2. обучаем решающие деревья, параметры по умолчанию
  3. подбираем оптимальные параметры с помощью gridsearch для решающих деревьев
  4. обучаем на наших данных случайный лес с парметрами: n_estimators = 100, criterion = 'gini', min_samples_leaf = 5, max_depth = 10
  5. используем для классификации градиентный бустинг с параметрами: n_estimators':200, 'max_depth':12, 'criterion':'friedman_mse', 'learning_rate':0.03, 'min_samples_leaf':16, 'min_samples_split':16
  6. объединяем алгоритмы логистической регрессии, решающих деревьев и градиентного спуска с помощью стекинга 
  7. находим, какие признаки демонстрируют наибольшую  важность в модели градиентного бустинга
  8. реализуем оптимизацию гиперпараметров с помощью Optuna


### **Результат**

Из 16 исходных признаков для построения модели было применено шесть. Остальные - это признаки, сконструированные в процессе исследования данных. Наиболее важные признаки duration, balance, poutcome_success. С помощью Optuna полцчили метрику f1-score = 0.80.
Возможно для увеличения метрики стоит изменить порог принятия решений.

### **Краткая информация**

****


:arrow_up:[к оглавлению](https://github.com/murattumov/project1/blob/master/README.md#Оглавление)
